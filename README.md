Sonant-X
========

[![Build Status](https://travis-ci.org/nicolas-van/sonant-x.svg?branch=master)](https://travis-ci.org/nicolas-van/sonant-x) [![npm](https://img.shields.io/npm/v/sonantx.svg)](https://www.npmjs.com/package/sonantx)

A very small JavaScript synthesizer library, suitable for small JavaScript demos or video games.

Sonant-X was created with video games' sound effects and music in mind, as well as size-restrained demos. It supports
both the HTML5 Audio object and the Web Audio API.

Songs for Sonant-X can be composed using [Sonant-X Live](https://github.com/nicolas-van/sonant-x-live).

Sonant-X is a fork of js-sonant by Marcus Geelnard.

Example
-------

Just test one of the available songs for Sonant-X Live, like this one: [Synth 4k](http://nicolas-van.github.io/sonant-x-live/#N4Igzg9gdg5gMgUyiAXARgEwGYA05owAiAhgC7GoDaoEYAxmgPoR2moCcetDjAJgmxQAGLvSb9SAVygJUIkNyYAPJADc5onqogAbVGgBsaTUwDuxVQgBmEAE4BbDQvoZmrDptcSn3LwOmyKAAsnowqUOrCodp66AAcGKHmljYOTlAQAJZgCIxWxPy2TmqMZOR0ANb6QvIlYJJg5JnI8WhxeCW2CDoIxDn6cW3GICX2faQIRejsiSBWSnmZOhNT8vN5XQCOTutdkFDEUHSBGACsIXML%2FDrEAJ6MpJn2gQZ469d3pfaCaELtl4wAA6HDYIbYoXAA4FQL6CIx4HQ2ZhiUHg%2BSIiB5BZWLZODGo1CQ%2FHEb4cC745LWOyOFCzQFUYyJRk4ZmsnBM9ksznMkSJXAhZn8nCnHCvADsOHapwAung6FRQC1KGggokROqcBqtZqddqNSq9bqjWgsO1DVrpQBfHCKhlYEXmo2O51O43210ms26q02kBKg06z2B90u7Um%2FWqwNBfUh11h01On22lDK2OhuPBiNqjMxh1ur3qpN%2BhnYHNl9MV8tF%2F1YSt18sNi3W5PKjAFxsd%2BvO6sMtCcE3GLsZzCvNAqztVy1FxRuQT%2FGfeKLOHgSAI%2BFHhSLyGcxdc8SmpGnblyz1Dzk%2BL490PxSGR71yb%2B%2BMXdL3yMA%2FU9JZHJ5AqTfScCMESlKQ5RVOgNQdMB9SNMQzTFMBXQ9H0gRYAYaFQaojBjI0%2F7TLM6xWEsKz6G82K4iggyQQCezQIcxz6KcrwAh89yPM8qAEVc3SfCSggYFxQIgjiYKEmRQkwnxqBBESSIziJaIIkihEUeiymqUpmJSUuFIWFSaRLvSKb6typkcuZXIWWyVlmZZsogPKKYtiaeYuW6rnum5IhecGHkij5PnebGbkBWmLLBfaPYpqFeZBX54XxbmvkJclSVxSl6WZSlLlWtOKIsHCJh8AIe7iP4d6vhuailc%2BugAbMM4fgZwxvgVZ6hJeHXlYE57XmE1WVX1L4JEkemHpxeAZNkuT5IUCFYWUxCVNUtTQQ0TQtEE5wikBWFIb0%2FS0mKGASrt2HjHhfaCURyx4ZCKmiUd1G7Ag%2Bz0T1O3vDxbFPC84msbCqAGGsCzQgSKDMesYPaXEzH4vJGkgPiD3gsMyMUadxKkhBcNIk1R54EZlCGsYgpcmTpOcrglN8uTVP2Y51DFtFnmeUEEoxSy7PZaz%2Fnc5zKoc7z2X8xFfNC%2F5wuCxlIsS1FyrRlz3mnEyiveYraAq0r2sBprqsRsr%2Bs6xrWsBurhvG%2BbLKm2rOs2xg8sDuFpMyc7wYu9TWCk17bsqp7g6%2B67TtBiHpxBV6ofh%2BF7SR9HwYx2H4VirlzbLkwbUoKdC4lYNZW3oEV7KANhe1bEbRZyi%2BMTcurgZztb6dTXxX59Xb6Pug0R1eg8JN1XtKTd%2BM1%2FqsmEgWBK2jzBG0DG0o%2F7ShnHHadowXVMmD3dixGXeJCkAc9Cy0QcRyBIYgkA%2BxJz%2Fd9gPoKcG8SeDkOgyC2k9%2FDKK7zpynkY9aPqY9swsY%2FHYLjTEfdIRE0rJTNkNM6YwMsnA%2BmcoFTM1TJLSWMc2ZMjZlHEKrNMF82wXzXBUsEwhUjOQkh6C47kKITrU0jsg5B1OHzXA6tqYsK5tTJhHD2Fcw5kwvhIcyFBxEdw3BGsyFiJoRQyRMdoyOzCkOZRnYU6%2BhnBnXqecaqrgqiXduLUUQviukVPuV5a7uEzl1QQ5jm5rkGg%2BAahihpdzFLYvuswpo%2Flmnhf4JRFrLQgqtLCU84ItGCYweeh12BCBiaPHCJFu4XEIlvKY10KIsP3pE16dFj6cUVixa%2BF8gZXxuPcbSpxhhQ2EhRe%2B0NsYGFAciHgn81KYhRnif%2BikkZIm0m098Y1PyGSoCo7yiDoHjJZAzFBNZYoeiUTLEmCy0ruRzGomg%2BVLEVxXDnEuuiC5FXbiXYxMxTGDIMg1E8mjrFPn2SUpuRzO5lziBcN8HiB7TV%2FHNWkwx%2FGgSWuBaMNQImhPgrSbaFxOjdAOoEGJcL4mr1QGKU6KTbppJ3hjX4INslvTyfEf4X0ykPF%2Bu1QpRLtLSyhDUx6yTn6SQaYBd%2BLTEbIx%2FqjTS4NMa9OxmgMUTS%2B7DEgROMMVMcAClFeK2mkqcBChlMgpyqDArCuVcoxh2ZRkqtUanf0bZNUarrIwther5ntn1YouZ%2BrjXmnWWnU8lEiqN2zi3XO%2FUIg1RfCXMxoRrlN0dRebqT5HlNw9aNFIQz5BeKHt8lUfjgIBPAmhDCZ1QWbW2nPaFC8IRwoiQky6SbUWJPSY9L2WTD7vX0AJUpnxikoE%2BtxclPKsCCTBq08S9SbEcoRo9fpHSO49PaRkjlFLub9oGWGgy8ghWWpMhyampl%2BTTIVUqF0Sr6yrpVfLFdyyPQGGzOu0Zm6yz7o7JrAOSzEpxnNVa69oYU72VsBAUwiAWhMSEMxJAvAAAKZRJgtFrJaIAAAA%3D) by m / Bits'n'Bites.

Installation
------------

```
npm install --save sonantx
```

Usage
-----

### Song Generation

To generate a whole song, you'll first need a song in JSON format generated by Sonant-X Live. An example can be found by clicking [here](http://nicolas-van.github.io/sonant-x-live/#N4Igzg9gdg5gMgUyiAXAZgOwBpzRgEQEMAXQ1AbVAjAGMBGAfQhuNWxGvoYBMFWUADDk6NexAK5QEqIR1qMAHkgBuM4fIbKIAG1R0AnACZ1XAO6FlCAGYQATgFtUaE4aYs2LnnzVyarsZLSKOycrkpQqoKeWroohgJ0nuaWNg5OOFAQAJZgCAxWhLy2PioMJKQ0ANZsABz6OKVg4mCkWcgodIZoACwNEQy2CNoIhLl6aABsk33KDPajxAjFHfqJIFYK%2BVnai8vG65tWgwCOqACsNWj1BwMIkFCEUDRBhme9N7zahACeDMRZ9iCExwGy8X1%2BhHs%2FE6a1BAAdHvkTqhgTcEVAylC9N12NobEwNEcEKcoiA8RB8odkR0cOSkcSUbT8ZDofozkyKclrHZHKS4RREsYhEJBVhBQBdHA0CigdrkOhvLAixXKoVinFKzXCrU65W9PWahVqhXYbXK4FmrXigC%2BWFlApVYsdRsNGst7p1Cv1Tu9LuVps9Z3qHoENptdt8jGY%2FBCGjEPhEXgkUgTGnCkVkiZiqFe7MjDC5qV5%2B1Cbn4NU88dJpYCKY6Fd8YRUemiOj0qySFm5aTiGWyuXyhSWJX65UIVSc%2Bn07EazVa7TOUymM1uw1GQToAi3W5X8xaw7iZzzoKs212OZBVIZ6CMl9u90ezxzR7vnx%2BfwBQQboLfEKxKAma54URIkSWPTZ0UxfgJlxfFE1Anw6RPak1iQ6l3jpFlzlgzkuyLdIQH5FB5SwYxRXI0jJRAaViPtYi6DQENdWYpjWJY9jhXDOj5S6Di%2BLYgT%2BKta0uPzaNUAbRMq0zOM%2BECVMuHTBTGGzasNELHkFNccSUEk2h%2FG8NS%2FCTeSjKbCItM0NszILPDNNJTIcjyAoihRWRSjHCcUDOdz%2BiaFpCDaVBugMFdBjXMYUG6CYBBnfo93PDpGLvU8dgPWErxJTc0DQfZQUGB8ng3eJXyGd9%2FkBYLSvBKC9FRYCMQQ7y70grCOgEBs6Xg6lZCQzLEPxJq80w%2F86BqHDbJSezZCI8gPUSOgqJoygQDlbU6DdT0NQ2gMRU2vaAx2rbdtdbAjvW%2Fb1UOnEw1tKgNB02MuGkkxRDkusZMU5saXzVTc1eybu15T7tPcYJK0MkGTI%2BzwlJ%2B0s%2FpfRtAfwhz%2B2codll82ZPOqbzsYYfz5z0HywqGEZIu6GodxAUoEoPeJZBPM8GZS6kYqZzYCugR8XkVD4yt%2BCqgk5sF3za0XIKayXEQljkCS4aX5eQ69esGnr5blsl8Q0nsZoFMVDYWsUlplVaBUupjzqE622NtjjbojRNHoBl781rEWAbhz6VOs%2F78114tPBd5G3Zrd6gmuUtvdbWIvU7Kae32RyBxcg8CdxnMQobWcAqC9qMDzUpwopjcBAmDbdwWBnulF1LEucG4msMfQJjyrm7h5orn3AsWhc%2FRkBZqtq6DodgGvpElG4ntqMEbrrCQ17WKRVrLlepYbmVGwwMJ1uy9ZwWb5tIw3DFN2jzfo51r%2BNS2bev30zmNM4TvNB27sv%2BUH8NJ%2FTqEy144HR%2Fs%2FV%2BTpgwsUdvdLgIcpKQ1dhHZSDAY6%2FWsgYEs6l968jWKWHSqJw78Chh7VAUd9JIO%2BlDVSaCE5AxbKtdGg5XKkg8sQCoeMGJxVmETQK7RGYExLuuYKFc1h02rssKhTcWZiLZtefQNR273i7k%2BXSQFNi%2Fg%2FJVAC1Vxb%2FleC1EC7M9EYlnhNbqqtlb9R%2Bmha888t7QWuHSQOPhZoUWcIkNA58VpygYutZKe1jTJW8a6Mivj1T%2BJ8eEoJhoAkhI2sEi6YSlSiS8bxEUKSxRoHZKk1xaSGLsk6M4EUGTDQ5JKQU9JmSxS8XyVEvJOSilZMSR%2FLx9Tyl%2F0KXklpR1cltNae0mpPTundKAUMq6%2FTQwiQ%2Fs7MGT03oEPgcmT2%2BZkFZj9kjRMjj0DBzBnpYyYdSFEJsss0hiM8ylg2bIFOGNGGdA4WUFh448aGH2LnYmukc79H4ZFK404q77j2EjZmaVljTwsbXGCd5uYPG7nEHoWj%2B4aPeD%2BQWtV0AgoYFLak8jWr%2FhqLvCkpiSRqxXhY1C6trGax0Z1PeidgaHwoOtE%2BLiPHcXiT%2Fb0rKAGOnmt0Z%2B7LImcr5eMiMa0Blcp6etMVADNqANGQK5igCkn0tFYK2VgYVUXUOpK1VrFIFiW2fMxBByfZkIskZX2sRjXnK2eWCGczQ4IMOeQ2OlkrV0KcgwhmSNmGsOxAIHotyuH5yMHQVExdyYCKSj0MevzErxG%2FIcSRF4m6Yp8qLSFvM6pwvUS8LNI8X6GMnhJAtbV4gmMXmY5elJC2WLJSSfYI1%2BBnFJbhGlTilUiiNp2xaUozZeLvoJAd%2F9%2BK3SorYCAphEALibY3JA3AAAK5QljtH0NaIAAA%3D) and choosing "Export JSON" in the menu on the left.

With that JSON song, we will be able to create a `MusicGenerator` object:

```
import * as sonantx from "sonantx";

var songGen = new sonantx.MusicGenerator(jsonSong);
```

Then it depends if you prefer to use the Web Audio API or the HTML5 `Audio` class.

#### Web Audio API

```
songGen.createAudioBuffer(function(buffer) {
    var source = audioCtx.createBufferSource();
    source.buffer = buffer;
    source.connect(audioCtx.destination);
    source.start();
});
```

Note that the `buffer` object can be stored and re-used any number of times.

#### Audio Class

```
songGen.createAudio(function(audio) {
    audio.play();
});
```

Note that, like all `Audio` objects, this one is not re-usable. If you want to be able to re-create `Audio` objects with
minimum delay, you can use the following syntax:

```
songGen.getAudioGenerator(function(audioGenerator) {
    var audio = audioGenerator.getAudio();
    audio.play();
});
```

Here the `audioGenerator` can be used to create any number of `Audio` instances without the need to re-calculate the
whole song. Remember that, even if the song is not re-calculated, each creation of an HTML5 `Audio` object provoke an
impossible to avoid delay in most browsers. It can be as short as 0.1 second but it's still a burden for applications
like video games. This is why using the Web Audio API is recommended.

### Single sounds generation

To generate single sound (suitable for video games sound effects) you'll first need an instrument description in JSON format generated by Sonant-X Live. To get an example one, you can click [here](http://nicolas-van.github.io/sonant-x-live/#N4Igzg9gdg5gMgUyiAXAZgOwBpzRgEQEMAXQ1AbVAjAGMBGAfQhuNWxGvoYBMFWUADDk6NexAK5QEqIR1qMAHkgBuM4fIbKIAG1R0AnACZ1XAO6FlCAGYQATgFtUaE4aYs2LnnzVyarsZLSKOycrkpQqoKeWroohgJ0nuaWNg5OOFAQAJZgCAxWhLy2PioMJKQ0ANZsABz6OKVg4mCkWcgodIZoACwNEQy2CNoIhLl6aABsk33KDPajxAjFHfqJIFYK%2BVnai8vG65tWgwCOqACsNWj1BwMIkFCEUDRBhme9N7zahACeDMRZ9iCExwGy8X1%2BhHs%2FE6a1BAAdHvkTqhgTcEVAylC9N12NobEwNEcEKcoiA8RB8odkR0cOSkcSUbT8ZDofozkyKclrHZHKS4RREsYhEJBVhBQBdHA0CigdrkOhvLAixXKoVinFKzXCrU65W9PWahVqhXYbXK4FmrXigC%2BWFlApVYsdRsNGst7p1Cv1Tu9LuVps9Z3qHoENptdt8jGY%2FBCGjEPhEXgkUgTGnCkVkiZiqFe7MjDC5qV5%2B1Cbn4NU88dJpYCKY6Fd8YRUemiOj0qySFm5aTiGWyuXyhSWJX65UIVSc%2Bn07EazVa7TOUymM1uw1GQToAi3W5X8xaw7iZzzoKs212OZBVIZ6CMl9u90ezxzR7vnx%2BfwBQQboLfEKxKAma54URIkSWPTZ0UxfgJlxfFE1Anw6RPak1iQ6l3jpFlzlgzkuyLdIQH5FB5SwYxRXI0jJRAaViPtYi6DQENdWYpjWJY9jhXDOj5S6Di%2BLYgT%2BKta0uPzaNUAbRMq0zOM%2BECVMuHTBTGGzasNELHkFNccSUEk2h%2FG8NS%2FCTeSjKbCItM0NszILPDNNJTIcjyAoihRWRSjHCcUDOdz%2BiaFpCDaVBugMFdBjXMYUG6CYBBnfo93PDpGLvU8dgPWErxJTc0DQfZQUGB8ng3eJXyGd9%2FkBYLSvBKC9FRYCMQQ7y70grCOgEBs6Xg6lZCQzLEPxJq80w%2F86BqHDbJSezZCI8gPUSOgqJoygQDlbU6DdT0NQ2gMRU2vaAx2rbdtdbAjvW%2Fb1UOnEw1tKgNB02MuGkkxRDkusZMU5saXzVTc1eybu15T7tPcYJK0MkGTI%2BzwlJ%2B0s%2FpfRtAfwhz%2B2codll82ZPOqbzsYYfz5z0HywqGEZIu6GodxAUoEoPeJZBPM8GZS6kYqZzYCugR8XkVD4yt%2BCqgk5sF3za0XIKayXEQljkCS4aX5eQ69esGnr5blsl8Q0nsZoFMVDYWsUlplVaBUupjzqE622NtjjbojRNHoBl781rEWAbhz6VOs%2F78114tPBd5G3Zrd6gmuUtvdbWIvU7Kae32RyBxcg8CdxnMQobWcAqC9qMDzUpwopjcBAmDbdwWBnulF1LEucG4msMfQJjyrm7h5orn3AsWhc%2FRkBZqtq6DodgGvpElG4ntqMEbrrCQ17WKRVrLlepYbmVGwwMJ1uy9ZwWb5tIw3DFN2jzfo51r%2BNS2bev30zmNM4TvNB27sv%2BUH8NJ%2FTqEy144HR%2Fs%2FV%2BTpgwsUdvdLgIcpKQ1dhHZSDAY6%2FWsgYEs6l968jWKWHSqJw78Chh7VAUd9JIO%2BlDVSaCE5AxbKtdGg5XKkg8sQCoeMGJxVmETQK7RGYExLuuYKFc1h02rssKhTcWZiLZtefQNR273i7k%2BXSQFNi%2Fg%2FJVAC1Vxb%2FleC1EC7M9EYlnhNbqqtlb9R%2Bmha888t7QWuHSQOPhZoUWcIkNA58VpygYutZKe1jTJW8a6Mivj1T%2BJ8eEoJhoAkhI2sEi6YSlSiS8bxEUKSxRoHZKk1xaSGLsk6M4EUGTDQ5JKQU9JmSxS8XyVEvJOSilZMSR%2FLx9Tyl%2F0KXklpR1cltNae0mpPTundKAUMq6%2FTQwiQ%2Fs7MGT03oEPgcmT2%2BZkFZj9kjRMjj0DBzBnpYyYdSFEJsss0hiM8ylg2bIFOGNGGdA4WUFh448aGH2LnYmukc79H4ZFK404q77j2EjZmaVljTwsbXGCd5uYPG7nEHoWj%2B4aPeD%2BQWtV0AgoYFLak8jWr%2FhqLvCkpiSRqxXhY1C6trGax0Z1PeidgaHwoOtE%2BLiPHcXiT%2Fb0rKAGOnmt0Z%2B7LImcr5eMiMa0Blcp6etMVADNqANGQK5igCkn0tFYK2VgYVUXUOpK1VrFIFiW2fMxBByfZkIskZX2sRjXnK2eWCGczQ4IMOeQ2OlkrV0KcgwhmSNmGsOxAIHotyuH5yMHQVExdyYCKSj0MevzErxG%2FIcSRF4m6Yp8qLSFvM6pwvUS8LNI8X6GMnhJAtbV4gmMXmY5elJC2WLJSSfYI1%2BBnFJbhGlTilUiiNp2xaUozZeLvoJAd%2F9%2BK3SorYCAphEALibY3JA3AAAK5QljtH0NaIAAA%3D) then choose one of the tracks of the sample song and click on the
"Export" button on the top right of the application. You will then get a JSON description of the instrument used for the
selected track.

With that instrument, we will be able to create a `SoundGenerator` object:

```
var soundGen = new sonantx.SoundGenerator(jsonInstrument);
```

Then it depends if you prefer to use the Web Audio API or the HTML5 `Audio` class.

#### Web Audio API

```
soundGen.createAudioBuffer(147, function(buffer) {
    var source = audioCtx.createBufferSource();
    source.buffer = buffer;
    source.connect(audioCtx.destination);
    source.start();
});
```

The first argument of `createAudioBuffer` is the number of the note to generate. In this example we use `147` which
corresponds to C5. `148` will correspond to C#5, `149` to D5, etc...

Note that the `buffer` object can be stored and re-used any number of times.

#### Audio Class

```
soundGen.createAudio(147, function(audio) {
    audio.play();
});

Note that, like all `Audio` objects, this one is not re-usable. If you want to be able to re-create `Audio` objects with
minimum delay, you can use the following syntax:

```
soundGen.getAudioGenerator(147, function(audioGenerator) {
    var audio = audioGenerator.getAudio();
    audio.play();
});
```

Here the `audioGenerator` can be used to create any number of `Audio` instances without the need to re-calculate the
whole sound. Remember that, even if the sound is not re-calculated, each creation of an HTML5 `Audio` object provoke an
impossible to avoid delay in most browsers. It can be as short as 0.1 second but it's still a burden for applications
like video games. This is why using the Web Audio API is recommended.

